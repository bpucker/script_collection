# script_collection
Collection of scripts to solve small bioinformatic challenges.


# identify_RBHs.py

Identification of Reciprocal Best BLAST Hits (RBHs) between to sets of sequences (protein/DNA). The scripts constructs BLAST databases and runs blastp/blastn in both directions. RBHs are identified and writen to a text file ('RBH_file.txt') in the specified output directory.

Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)
2) BLAST (makeblastdb, blastn, and blastp should be in PATH)

Usage:

python identify_RBHs.py \
--input1 <FASTA_FILE_1> \
--input2 <FASTA_FILE2> \
--prefix <OUTPUT_DIRECTORY_NAME> \
--seq_type <prot|nucl> \
--cpu <NUMBER_OF_CPUs_TO_USE>


Suggested citation:

Pucker et al., 2016: 'A De Novo Genome Sequence Assembly of the Arabidopsis thaliana Accession Niederzenz-1 Displays Presence/Absence Variation and Strong Synteny'
http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0164321





# sort_contigs_on_ref.py

Whole Genome Shotgun (WGS) assembly contigs can be ordered and oriented based on an available reference sequence. This script does a placement of all given sequences based on the central position of their best BLASTn hit against the reference sequence. A new FASTA file is constructed, in which all seqeuences are saved under new systematic names (scaffold<running_number>). Association between old and new names is printed during this process and can easily be written into a documentation file.

Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)
2) BLAST (makeblastdb and blastn should be in PATH)

Usage:

python sort_contigs_on_ref.py \
--contig_file <FULL_PATH_TO_FILE> \
--ref_file <FULL_PATH_TO_FILE> \
--output_dir <FULL_PATH_TO_DIR> > <DOCUMENTATION_FILE>

Suggested citation:

Pucker et al., 2016: 'A De Novo Genome Sequence Assembly of the Arabidopsis thaliana Accession Niederzenz-1 Displays Presence/Absence Variation and Strong Synteny'
http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0164321





# split_FASTQ.py

Splits FASTQ file with alternating mate1 and mate2 reads of paired-end sequencing into two separate files with mate1 and mate2, respectively. Can be applied after downloading FASTQ files from the SRA via webbrowser. New files will be placed next to the original file with '_1' and '_2' added to their file base name. This script can handle raw FASTQ files (.fastq) as well as gzip compressed files (.fastq.gz).

Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)

Usage:

python split_FASTQ.py \
--in_file <FULL_PATH_TO_FILE>


Suggested citation:

this repository





# sort_vcf_by_fasta.py

A given VCF file is sorted based on the provided FASTA file. The chromosome order and numeric positions within the chromosome sequences are taken into account to adjust the VCF file. This can be helpful during variant calling with GATK.

Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)

Usage:

python sort_vcf_by_fasta.py \
--vcf <FULL_PATH_TO_INPUT_VCF> \
--fasta <FULL_PATH_TO_INPUT_FASTA_FILE> \
--output <FULL_PATH_TO_OUTPUT_VCF_FILE>


Suggested citation:

this repository




# contig_stats.py
This script can be used to calculate some basic statistics and to remove short contigs after generating a de novo assembly. Contigs above the cutoff are written into a new FASTA file which is placed next to the original file. In addition, some statistics about his cleaned assembly are calculated and written into a separate text file. This script was tested on assemblies generated by CLC Genomics Workbench, SOAPdenovo2, and Trinity.

Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)

Usage:

python contig_stats.py \
--input <FILENAME> \
--min_contig_len <MINIMLAL_CONTIG_LENGTH_TO_KEEP> [default=500]


Suggested citation:

Pucker et al., 2016: 'A De Novo Genome Sequence Assembly of the Arabidopsis thaliana Accession Niederzenz-1 Displays Presence/Absence Variation and Strong Synteny'
http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0164321



# grep_seqs_from_fastq.py
This script greps reads from a given FASTQ file if they match a provided sequence. It can be used to collect data for manual improvement of critical region in an assembly e.g. to extend contigs.


Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)

Usage:

python grep_seqs_from_fastq.py \
--in <FULL_PATH_TO_FASTQ_FILE> \
--out <FULL_PATH_TO_OUTPUT_FILE> \
--seq <SEQUENCE_TO_FIND>

Suggested citation:

this repository


# candidate_gene_identification.py
This script can be used to identify candidate genes for complete pathways or gene families. A set of query protein sequences e.g. from different other species is needed for the search. Best candidates are first identified via BLASTp.

optional:

A phylogenetic tree is constructed to enable manual inspection of the results. This requires some external tools listed below.


Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)
2) BLAST (blastp, makeblastdb should be in PATH)
optional:
3) MAFFT
4) pxclsq
5) FastTree

Usage:

python candidate_gene_identification.py\n
--query <FULL_PATH_TO_QUERY_FILE>\n
--pep <FULL_PATH_TO_SUBJECT_PEPTIDE_FILE>\n
--prefix <FULL_PATH_TO_OUTPUT_DIRECTORY>\n


Suggested citation:

this repository



# get_reads_from_bam.py
This script can be used to extract paired-end reads after mapping to a reference sequence. An additional length filter can be applied to extract only read paires in which both mates have a sufficient length.



Requirements:

1) Python 2.7.x (other Python 2 versions should work as well)
2) samtools
3) bedtools

Usage:

python get_reads_from_bam.py\n
--bam <FULL_PATH_TO_BAM>\n
--out <FULL_PATH_TO_OUTPUT_DIR>\n

optional:

--min_len <MIN_READ_LENGTH>\n


Suggested citation:

this repository





